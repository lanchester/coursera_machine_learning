## 最大マージン分類の背後の数学(任意)

### ベクトルの内積

<img width="965" alt="2016-08-29 17 22 43" src="https://cloud.githubusercontent.com/assets/6447085/18045312/3cf6b144-6e0d-11e6-9c2b-95c37a4e4492.png">

ベクトルの性質について $u$ ,$v$ のベクトルがある時、 $\[ \|u\| \]$ をベクトル $u$ のノルム(絶対値)と言う。ノルムは ピタゴラスの定理より $\[ \|x\| \] = \sqrt[ｎ]{\mathstrut u_1^2 + u_2^2}$ となる。

ベクトル $v$ をプロットし $u$ に垂線を下ろすとpは $v$ を $u$ に射影したときの長さになる。そして内積 $u^Tv$ は、$p \[ \|u\| \] = u_1v_1 + u_2v_2$ になる。

$u$ と $v$ が90度以上離れている場合はpはマイナスの値になる。

### SVM決定境界

<img width="964" alt="2016-08-29 17 23 34" src="https://cloud.githubusercontent.com/assets/6447085/18045354/7675386e-6e0d-11e6-9586-66670f8adf25.png">

$\theta_0 = 0, n = 2$ とすると、目的関数は $\frac{1}{2}(\theta_1^2 + \theta_2^2)$ となり、これは $\frac{1}{2}(\sqrt[ｎ]{\mathstrut \theta_1^2 + \theta_2^2})^2$ と書ける。これはベクトルのノルムに等しい。つまり $\frac{1}{2}\[ \| \theta \| \]$ になる。

$\theta^Tx$ はベクトルの内積であり、それはベクトル $x$ のベクトル $\theta $ に対する射影の長さ $p$ × ベクトル $\theta$ ノルム(絶対値)と等しい。つまり
$\theta^Tx = p\[ \| \theta \| \] \geq 1$ になり、これは前提条件から1以上になる。

### SVM決定境界

<img width="963" alt="2016-08-29 17 26 11" src="https://cloud.githubusercontent.com/assets/6447085/18045424/b6f7683a-6e0d-11e6-9815-17ee912123b0.png">

以上を踏まえてSVMが決定境界を決める際に何をしているかをグラフで言うと、 $p$ が0に近い値(プラスマイナスどちらも)ならば全体が1以上、あるいは-1以下になるように $\[\| \theta \|\]$ を大きくする必要がある。しかしこれはコスト関数の最小化と反するので、なるべく $p$ を大きくして $\[\| \theta \|\]$ を小さくする道を進む。そしてpが最も大きくなるのがマージンを大きくした時になる。

決定境界と垂直の $\theta $ ベクトルをとることで射影の長さを求められる。サポートベクターとはこのマージンをきめるサポートをするベクトルのこと。
