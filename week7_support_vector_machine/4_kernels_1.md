## カーネル1

### 非線形決定境界

<img width="963" alt="2016-08-29 17 27 41" src="https://cloud.githubusercontent.com/assets/6447085/18045474/eaadb698-6e0d-11e6-99ba-7032167e2530.png">

$\theta_0 + \theta_1x_1 + \theta_2x_2 + \theta_3x_1x_2 + \theta_4x_1^2 + \theta_5x_2^2 + ... \geq 0$ の時1となるような決定境界を計算したい時、 $x_1 = f_1, x_2 = x_2, x_1x_2 = f_3, ,.. $ として、 $\theta_0 + \theta_1f_1 + \theta_2f_2 + \theta_3f_3 + ... $ のように書くことにする。

この時、fに高次多項式の代わりにもっと良いフィーチャーをいれられないか考える。

### カーネル

<img width="962" alt="2016-08-29 17 28 21" src="https://cloud.githubusercontent.com/assets/6447085/18045495/07c880a0-6e0e-11e6-8359-762a96a88f0a.png">

フィーチャーの座標空間において、いくつかの点を手動で選ぶ。ここではフィーチャーは2つだけだが実際には大量のフィーチャーがある。選ばれた $l^{(1)}, l^{(2)}, l^{(3)}$ の点をランドマークと呼ぶ。

ある手本ベクトルxが与えられたとき、 $f_1$ をxと $l^{(1)}$ との類似度をsimilarity関数で定義する。つまり $f_1 = similarity(x, l^{(1)}) = exp(-\frac{\|x - l^{(1)}\|^2}{2\sigma^2})$ とする。 $f_2, f_3$ も同様にする。

このsimilarityを求める関数を数学的にカーネルと言う。ここで用いられているのはガウスカーネルと呼ばれる関数。カーネルには様々な種類がある。similarity は単にkと書かれることもある。

### カーネルと類似性

<img width="965" alt="2016-08-29 17 29 07" src="https://cloud.githubusercontent.com/assets/6447085/18045511/1f1c4c6e-6e0e-11e6-9613-20000a80232d.png">

xベクトル - ランドマークベクトルのノルムはxベクトルの各要素 - ランドマークベクトルの各要素を足し合わせたものと同じ。


xとランドマークが近い場合、分子のノルムは0に非常に近くなる。分数全体は0に近似しexpの結果、つまりeの約-0乗は1に近くなる。よって $f_1$ は約1になる。

xとランドマークが遠い場合は分子が非常に大きい値となり、分数全体だは大きいマイナスの値となるので、expの結果は約0になる。

ガウスカーネルは与えられたフィーチャーがランドマークとどれだけ似ているかを図っている。

### 例

<img width="960" alt="2016-08-29 17 29 48" src="https://cloud.githubusercontent.com/assets/6447085/18045537/3bb863b2-6e0e-11e6-8ee5-30c5b7a76f74.png">

<img width="961" alt="2016-08-29 17 30 43" src="https://cloud.githubusercontent.com/assets/6447085/18045558/57ae144a-6e0e-11e6-96cd-18443ab3005d.png">

グラフ(左)はフィーチャーがランドマークに近づくとfの値がどうなるかを示している。分母に $\sigma^2 = 0.5$ を与えるとこぶが鋭く小さくなる(中央)。 $\sigma^2 = 3$ とするとこぶは広く緩やかになる。 $\sigma^2$ の値は類似度の判定に影響（与える。

例えばフィーチャーベクトルxが $l^{(1)}$ の近くに与えられた時は $f_1 \approx 1, f_2 \approx 0, f_3 \approx 0$ になる。与えられたフィーチャーがどのランドマークに近いか判別し、仮説のパラメータによって最終的な1か0かの予測をする。
