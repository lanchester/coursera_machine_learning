## 確率的最急降下法

### 最急降下法を用いた線形回帰

<img width="963" alt="2016-10-25 18 28 40" src="https://cloud.githubusercontent.com/assets/6447085/19680561/2c52a342-9ae1-11e6-9ea0-ee73189ca610.png">

例として線形回帰を用いる(確率的最急降下法はこれ以外にも対応可能)。二乗誤差の和を最適化する場合、必ず真っ直ぐグローバル最小に向かう。ただしデータセットが多い場合、偏微分項の計算には時間がかかる。この一度に全てのデータについて和を取る方法をバッチ最急降下法と言う。

### バッチ最急降下法と確率的最急降下法

<img width="961" alt="2016-10-25 18 31 39" src="https://cloud.githubusercontent.com/assets/6447085/19680600/50715002-9ae1-11e6-8bdd-b18b1d72ecf9.png">

確率的最急降下法ではまず一つの手本についての誤差を求める関数を定義して、それで以前と同じコスト関数を定義する。そして次のステップを行う。
1. m個のデータセットをランダムに並べ替え
2. i = 1 ~ mについて偏微分項の和ではなくi番目の項の偏微分項のみを使ってアップデートを行う

### 確率的最急降下法

<img width="963" alt="2016-10-25 18 32 22" src="https://cloud.githubusercontent.com/assets/6447085/19680619/67f8c5c0-9ae1-11e6-8c7f-b5872a432216.png">

バッチ最急降下法が必ずグローバル最小に向かうのに対して、確率的最急降下法は大体グローバル最小に向かうがランダムに遠回りをしながら探すようにパラメータを更新する。

そしてグローバル最小に極めて近い領域で小さく変動する。バッチ最急降下法のように完全に収束はしないが精度の高いモデルを得られる。外側のrepeat処理については多くて10回以内にすることが多い。
