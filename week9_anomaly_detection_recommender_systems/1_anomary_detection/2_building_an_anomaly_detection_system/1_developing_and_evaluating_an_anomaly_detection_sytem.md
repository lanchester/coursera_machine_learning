## 異常検出システムの開発と評価

### 実数による評価指標の重要性

<img width="962" alt="2016-10-25 17 39 02" src="https://cloud.githubusercontent.com/assets/6447085/19678743/f7e7f8de-9ad9-11e6-8ee5-711fb19c8d8f.png">

学習アルゴリズムを開発する時(追加のフィーチャーの選択など)は評価指標があると比較が簡単。異常検出の評価には正常か異常でラベル付けされたデータがあるとして、これをクロスバリデーションセットとテストセットに使ってアルゴリズムを評価する。

### 航空機エンジンの例

<img width="961" alt="2016-10-25 17 40 31" src="https://cloud.githubusercontent.com/assets/6447085/19678778/2996aed4-9ada-11e6-8101-bd3f058c040f.png">

10000件の正常品と20件の欠陥品があるとする(通常は20-50程度の異常であることが多い)。そして正常なデータでトレーニングし、クロスバリデーションとテストセットで正常と異常なデータをテストする。ここでもクロスバリデーションセットとテストセットのデータに同じものは使わない。

### アルゴリズムの評価

<img width="964" alt="2016-10-25 17 41 28" src="https://cloud.githubusercontent.com/assets/6447085/19678808/48de8e2e-9ada-11e6-8bed-1b1bc2c59922.png">

まずトレーニングセットでガウス分布モデル $p(x)$ をフィッティングする。次にクロスバリデーションセットの p における分布の値が $\epsilon$ より大きければ正常、小さければ異常とする。

テストセット(とクロスバリデーションセット)には異常か正常かのラベル付けがされているので、これらの精度によってアルゴリズムを評価する。また、ラベル付けされたデータは非常に歪んだ(正常が多い)割合になっている。

異常検出アルゴリズムのデータの割合は歪んでいるため、その評価に精度の値をそのまま使うことはできない。f1スコア等を使う。

$\epsilon$ を決めるには色々な値を試す必要があるがf1スコアが最大になるような値を選ぶ方法がある。
