## コンテンツベースレコメンデーション

### コンテンツベースレコメンドシステム

<img width="960" alt="2016-10-25 18 06 39" src="https://cloud.githubusercontent.com/assets/6447085/19679699/d08651a6-9add-11e6-947d-6d5742ef6f0f.png">

前回のレーティング表に恋愛映画とアクション映画の度合いを表す値を加えフィーチャーとする。予測の方法としては各人のレーティング予測を独立した線形回帰として扱う。ユーザーがそれぞれ別のパラメータベクトル $\theta^{(j)}$ を持っていて映画の要素のフィーチャーベクトル(ロマンスは0.99、アクションは0など)の内積でレーティングの値を予測する。

### 問題の定式化

<img width="963" alt="2016-10-25 18 07 35" src="https://cloud.githubusercontent.com/assets/6447085/19679723/ef0dbc9a-9add-11e6-821d-dcf03d7a0d23.png">

コスト関数は最小二乗法と同じになる。ただし、和を取る対象は $r(i, j) = 1$ 、つまりユーザーjがレーティングした映画全てになる。

### 目的関数の最適化

<img width="962" alt="2016-10-25 18 08 18" src="https://cloud.githubusercontent.com/assets/6447085/19679739/0745cd52-9ade-11e6-9eb2-27f656c8bed0.png">

コスト関数はユーザー毎にあり求めるパラメータベクトル $\theta^{(j)}$ もユーザー毎にある。そしてそのコスト関数を全てのユーザーについて行い全体を最適化する。

### 最適化アルゴリズム

<img width="960" alt="2016-10-25 18 08 52" src="https://cloud.githubusercontent.com/assets/6447085/19679760/1ca030ac-9ade-11e6-980a-99d552ceb2b2.png">

最適化のアルゴリズムは通常の回帰分析の最急降下法とほぼ同じ。kの値による場合分けがある。

以前と同じように和の項は偏微分。

コンテンツベースのレコメンデーションは各コンテンツがどういった種類のものなのかを特定できるフィーチャーが必要になる。
