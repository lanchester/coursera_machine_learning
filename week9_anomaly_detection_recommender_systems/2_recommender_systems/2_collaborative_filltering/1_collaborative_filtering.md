## 協調フィルタリング

アルゴリズムがフィーチャーを学習するレコメンデーション。

### 問題の動機付け

<img width="961" alt="2016-10-25 18 10 54" src="https://cloud.githubusercontent.com/assets/6447085/19679835/657f1086-9ade-11e6-993c-b3c5839e543d.png">

コンテンツベースレコメンデーションでは映画の内容をフィーチャーとしていたがそれが不明な場合を考える。ユーザーがどういった種類の映画がどれくらい好きかが分かれば、その人のパラメータベクトルから逆算的にコンテンツのフィーチャーを作ることが出来、内容も類推できる。

### 最適化アルゴリズム

<img width="960" alt="2016-10-25 18 12 50" src="https://cloud.githubusercontent.com/assets/6447085/19679907/a963c29c-9ade-11e6-86a8-c713fe624f6c.png">

ユーザー $1 ~ n_u$ のパラメータベクトル $\theta^{(1)} ~ \theta^{(n_u)}$ を事前に知っている前提で、コンテンツのフィーチャーベクトル $x^{(i)}$ を学習する。映画iをレーティングしたユーザー1 ~ jについてユーザーのパラメータと映画フィーチャーの内積によるレーティングの予測と実際のレーティングとの二乗誤差の和をとる。これを全ての映画について行いその誤差を最小化する。

### 協調フィルタリング

<img width="960" alt="2016-10-25 18 13 37" src="https://cloud.githubusercontent.com/assets/6447085/19679946/c7079fee-9ade-11e6-8b5c-1656113ad779.png">

これまでのアルゴリズムではフィーチャーベクトルが与えられてパラメータベクトルを予測してきた。このアルゴリズムでは反対にユーザーのパラメータかま与えられてコンテンツのフィーチャーを予測している。最初にランダムなパラメータを与える→パラメータからフィーチャーを予測する→フィーチャーからパラメータを最適化する→ ... と繰り返すことでモデルを実際に改善していくことが出来る。
