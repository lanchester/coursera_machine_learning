## 収束チェック

バックプロパゲーションは一見うまくいっているように見えてバグりやすい。コスト関数が収束してても実装に不備がある場合がある

### 収束値計算

![2016-07-26 16 25 08](https://cloud.githubusercontent.com/assets/6447085/17129384/bf1d20fc-534d-11e6-8459-7f31fc08078d.png)


$\Theta$ からわずかな値 $\pm\epsilon$ 分だけずらした点の $J(\Theta)$ の値同士を結び $\Theta$ の微分と近似する。 $\epsilon$ の値は $10^{-4}$ 辺りにするとうまく行く。これは単に数値計算上の問題である。

下はOctaveによる実装サンプル

### パラメータベクトル $\Theta$

![2016-07-26 16 26 22](https://cloud.githubusercontent.com/assets/6447085/17129392/c98e074a-534d-11e6-9b06-b08b2fafeafa.png)

$\Theta$ がベクトルの場合 $\epsilon$ はベクトルの各項目のパラメータに $\pm\epsilon$ を加えた値が各微分の近似となる。

### Octave 実装

![2016-07-26 16 27 36](https://cloud.githubusercontent.com/assets/6447085/17129407/e7555710-534d-11e6-8313-8b46ad7fdbf1.png)

バックプロパゲーションで求めたベクトルDVecとイプシロンチェック法により求めたGradApproxとがほぼ同じであることを確認する。小数点数桁の度合いで非常に近い値であればバックプロパゲーションは上手くいっているということになる。

### 実装メモ&重要な点

![2016-07-26 16 28 33](https://cloud.githubusercontent.com/assets/6447085/17129430/0858a034-534e-11e6-898a-fc85255f7c17.png)

実装する上のポイントは
1. まずアンロール済みのDVec、すなわち $D^{(1)}$, D^{(2)}, D^{(3)}$ を求める
2. $\epsilon $ によるgradApprox のチェックを実装する
3. 1と2が近似かどうかを確認する(小数点第2位や3位など)
4. 実際の学習時には収束チェックをしないことが重要
イプシロンによる収束チェックは時間がかかるため、バックプロパゲーションが正しく収束していることが確認できたらオフにうる。
