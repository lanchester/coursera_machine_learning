## 主成分数の選択

### 主成分数kの選択

<img width="964" alt="2016-09-06 14 57 53" src="https://cloud.githubusercontent.com/assets/6447085/18263118/5ad0bdf0-7442-11e6-8224-95d220c9e19e.png">

PCAは二乗射影誤差の平均を最小化する。データ全体の分散は原点からの距離の二乗の平均。データ全体は原点からどれくらい離れているかを表す。そしてkはしばしば $\frac{誤差}{分散} \leq 0.01$ になるように選ぶ。これは、99%の分散が保持されている、と言うような言い方をする。0.01は0.01～0.1の範囲をとることもある。実際のデータはフィーチャーが互いに高い相関を持っていることが多く、多くの次元を削減しつつ99%の分散を保持することもできる。

### 主成分数kの選択

<img width="961" alt="2016-09-06 14 59 08" src="https://cloud.githubusercontent.com/assets/6447085/18263131/82ce4660-7442-11e6-8fb2-be9eed1ec81b.png">

具体的なkの選択アルゴリズムとしてはk = 1から始めて、 $\frac{誤差}{分散}$ に代入し、 $\leq 0.01$ を満たせば1を、満たさなければk = 2として再度試す、というのを繰り返す方法がある。しかしこれは効率が悪い。代わりにsvd(特異値分解)を実行したときの [U, S, V] のうちSがこの分母と分子の値を含んだ行列になっているため、簡単な計算で求めることができる。

### 主成分数kの選択

<img width="962" alt="2016-09-06 14 59 51" src="https://cloud.githubusercontent.com/assets/6447085/18263145/977345f2-7442-11e6-861c-997bcf168100.png">

まとめるとsvdを実行して [U, S, V] のうちのS行列を保存しておきそこ対角線上の要素を使って分散の保持率を計算する。
