## クラスタリング: k平均法

### k平均法イメージ

![14726101671uwouzowvpzycsx1472610164](https://cloud.githubusercontent.com/assets/6447085/18113801/623fd8de-6f6d-11e6-8977-4dd755e03247.gif)

k平均法アルゴリズムではまずクラスタ重心と呼ばれる点をランダムに決定する。そして2つのステップを経てデータをクラスタリングする。

1つ目のステップはクラスタ割り付けステップで、各手本を順に見ていきそれぞれの重心のどちらに近いかによってクラスタに割り振る。

2つ目のステップは重心の移動ステップで、1つ目のステップで割り振った点の集合の平均の場所へと重心を移動させる。

2つ目のステップが終わったらまた1つ目に戻りイテレーションを繰り返す。最終的に収束した点がk平均法が選んだクラスタの各重心となる。

### k平均法

<img width="963" alt="2016-08-31 11 25 01" src="https://cloud.githubusercontent.com/assets/6447085/18113831/986555ce-6f6d-11e6-90a5-7ae217a0d475.png">

k平均法への入力は分けたいクラスタ数kとラベル無しトレーニングセットx。xは $x_0 = 1$ を加えずn次元ベクトルになる。

### k平均法

<img width="962" alt="2016-08-31 11 26 19" src="https://cloud.githubusercontent.com/assets/6447085/18113848/c37ac8b6-6f6d-11e6-9ab9-017d38e61165.png">

まずランダムに $\mu_1, \mu_2, ... , \mu_K$ までの $k$ 個の重心を選ぶ。
その後クラスタ割り付けステップで各手本 $c^{(i)}$ と $\mu_k$ との距離が最も小さくなるような $k$ を選び出しその値を $c^{(i)}$ にセットする。次の重心移動ステップで前ステップでクラスタリングされた各手本について平均を求め、そこに重心を移動させる。

もし1つ目のステップで1つも手本がセットされなかったクラスタ重心があった場合は、単にその重心を取り除く。クラスタ数を減らしたくない場合はその重心を最初期化する。

### 非分離クラスタにおけるk平均法

<img width="963" alt="2016-08-31 11 27 04" src="https://cloud.githubusercontent.com/assets/6447085/18113864/e2a5fc92-6f6d-11e6-8694-95f60aaab2c9.png">

手本が明確に分かれていなくてもk平均法は上手くクラスタリングしてくれる。例えばTシャツのサイズやマーケットセグメンテーションなど。
